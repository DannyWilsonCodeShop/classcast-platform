# CloudFront 403 Error on Assignment Updates

## Issue
When trying to update an assignment (e.g., change due date), getting a 403 Forbidden error from CloudFront.

## Error Details
```
403 ERROR
The request could not be satisfied.
Request blocked.
Generated by cloudfront (CloudFront)
```

## Root Cause
CloudFront is blocking PUT requests to `/api/assignments/[assignmentId]` endpoint. This happens because:

1. **CloudFront Cache** - Old deployment is cached
2. **WAF Rules** - May be blocking certain request patterns
3. **Origin Configuration** - CloudFront might not be properly configured to forward PUT requests

## Immediate Workaround
Users can try:
1. Clear browser cache (Cmd+Shift+R or Ctrl+Shift+R)
2. Logout and login again
3. Use incognito/private browsing mode
4. Wait 5-10 minutes for CloudFront cache to expire

## Permanent Fix Required

### Option 1: Invalidate CloudFront Cache
```bash
aws cloudfront create-invalidation \
  --distribution-id YOUR_DISTRIBUTION_ID \
  --paths "/api/*" "/*"
```

### Option 2: Update CloudFront Behavior
Ensure CloudFront is configured to:
- Forward all HTTP methods (GET, POST, PUT, DELETE, OPTIONS)
- Forward all headers for API routes
- Not cache API responses (or use very short TTL)

### Option 3: Check WAF Rules
Review AWS WAF rules to ensure they're not blocking:
- PUT requests
- Large request bodies
- Specific content types

## Related Issues
- Videos not loading on grading page (purple screen with "Upload" text)
- YouTube thumbnail 404 errors
- These may also be CloudFront caching issues

## Status
⚠️ **NEEDS AWS CONFIGURATION** - Requires CloudFront/WAF changes

## Recommended Actions
1. Invalidate CloudFront cache after each deployment
2. Configure CloudFront to not cache `/api/*` routes
3. Ensure all HTTP methods are allowed for API routes
4. Review and update WAF rules if necessary
